<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>PHP ajax</title>
  <script src="http://code.jquery.com/jquery-1.6.2.min.js"></script>
  <script>
  $(document).ready(function() {
    $('#send').click(function() {
      var data = {
        'request' : $('#request').val(),
        'action' : $('#action').val(),
    
    };
      $.ajax({
        type: "POST",
        url: "send.php",
        data: data,
      }).success(function(data, dataType) {
        alert(data);
      }).error(function(XMLHttpRequest, textStatus, errorThrown) {
        alert('Error : ' + errorThrown);
      });
      return false;
    });
    $('#read').click(function() {
      var data = {
        'request' : $('#request').val(),
        'action' : $('#action').val(),
    
    };
      $.ajax({
        type: "POST",
        url: "read.php",
        data: data,
      }).success(function(data, dataType) {
	       document.getElementById( "request" ).value = data ;


      }).error(function(XMLHttpRequest, textStatus, errorThrown) {
        alert('Error : ' + errorThrown);
      });
      return false;
    });


  });
  </script>
</head>
<body>
  <h1>HTMLを実験する</h1>
  <a id="link0" href="html_file0.html" target="_blank">htmlを開く</a><br>

  <form method="post">
    <p><textarea name="request" id="request" cols="80" rows="30">ここにhtmlを記述してください</textarea></p>
    <p><input id="send" value="書き込み" type="submit" /></p>
    <p><input id="read" value="現在の値を読み出し" type="submit" /></p>
    <p><select name="action" id="action">
      <option value="0">パターン0</option>
      <option value="1">パターン1</option>
      <option value="2">パターン2</option>
      <option value="3">パターン3</option>
      </select></p>
      <script>
        document.getElementById("action").addEventListener("change", function(){

            var age_elem = document.getElementById("action");

            var s_value = age_elem.options[age_elem.selectedIndex].value;

            console.log(s_value);
            const target = document.getElementById("link0");
            if(s_value=="0")target.href = "html_file0.html";
            if(s_value=="1")target.href = "html_file1.html";
            if(s_value=="2")target.href = "html_file2.html";
            if(s_value=="3")target.href = "html_file3.html";

      }, false);

      </script>

  </form>
</body>
</html>
